<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>练习4：淡入-setimeOut</title>
</head>

<body>
    <div id="fade-obj" style="width:300px;height:300px;background:#000"></div>
    <button id="fade-btn">淡出</button>

    <script>
        var t;
        var objOpacity = 1;
        // 开关量1，是setInterval只能执行一次
        var flag = 0;
        //开关量2，使函数分开运行
        var onFlag=0;

        var btn = document.getElementById("fade-btn")
        var obj = document.getElementById("fade-obj")

        btn.addEventListener('click', fadeOut);
        btn.addEventListener('click', fadeIn);

        function fadeOut() {
            if(onFlag==0){
                objOpacity=objOpacity-0.1;
                obj.style.opacity = objOpacity;
                
                console.log(objOpacity);
                if (objOpacity>0 && flag == 0) {
                    //setInterval、setTimeout会累加
                    //但是setTimeOut执行结束之后就会注销
                    btn.setAttribute('disabled', true);
                    t = setInterval(fadeOut, 500);
                    flag = 1;
                } else if (objOpacity <= 0 && flag == 1) {
                    console.log('stop');
                    clearInterval(t);
                    btn.removeAttribute('disabled', false);
                    btn.innerText = "淡入"
                    // clearTimeout(t);
                    flag = 0;
                    onFlag=1;
                }
            }
        }
        function fadeIn() {
            if(onFlag==1){
                objOpacity=objOpacity+0.1;
                obj.style.opacity = objOpacity;
                
                console.log(objOpacity);
                if (objOpacity<1 && flag == 0) {
                    btn.setAttribute('disabled', true);
                    t = setInterval(fadeIn, 500);
                    flag = 1;
                } else if (objOpacity >= 1 && flag == 1) {
                    console.log('stop');
                    clearInterval(t);
                    btn.removeAttribute('disabled', false);
                    btn.innerText = "淡入"
                    flag = 0;
                    onFlag=0;
                }
            }
        }


        

    </script>
</body>

</html>